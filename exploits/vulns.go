package exploits

import (
	semver "github.com/Feals-404/GLPIAnarchy/semver"
)

type Vulnerability struct {
	ID       string
	SEVERITY string
	URL      string
	PATCHv   string
	RUN      func(string)
	RUNTBSQL func(string, int)
	TAG      string
	CHECK    func(string) bool
	Version  *semver.Constraints
}

var Vulnerabilities = []Vulnerability{
	{
		ID:       "CVE-2020-5248",
		SEVERITY: "Moderate",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-j222-j9mf-h6j9",
		PATCHv:   "9.5.2",
		CHECK:    CheckCVE20205248,
		Version:  semver.NewConstraint("0.70 - 9.5.1"),
	},
	{
		ID:       "CVE-2020-15175",
		SEVERITY: "High",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-rm52-jx9h-rwcp",
		PATCHv:   "9.4.6",
		RUN:      CVE202015175,
		TAG:      "File Deletion",
		CHECK:    CheckCVE202015175,
		Version:  semver.NewConstraint("* - 9.4.5"),
	},
	{
		ID:       "CVE-2020-15176",
		SEVERITY: "Critical",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-x93w-64x9-58qw",
		PATCHv:   "9.5.2",
		CHECK:    CheckCVE202015176,
		Version:  semver.NewConstraint("0.68 - 9.5.1"),
	},
	{
		ID:       "CVE-2021-43778",
		SEVERITY: "Critical",
		URL:      "https://github.com/pluginsGLPI/barcode/security/advisories/GHSA-2pjh-h828-wcw9",
		PATCHv:   "9.5.12",
		RUN:      CVE202143778,
		CHECK:    CheckCVE202143778,
		Version:  semver.NewConstraint("0.90 - 9.5.12"),
	},
	{
		ID:       "CVE-2022-31061",
		SEVERITY: "Critical",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-w2gc-v2gm-q7wq",
		PATCHv:   "9.5.8 & 10.0.2",
		RUNTBSQL: CVE202231061,
		TAG:      "TB SQLi",
		CHECK:    CheckCVE202231061,
		Version:  semver.NewConstraint("9.3.0 - 9.5.7 || 10.0.0 - 10.0.1"),
	},
	{
		ID:       "CVE-2022-35914",
		SEVERITY: "Critical",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-c5gx-789q-5pcr",
		PATCHv:   "9.5.9 & 10.0.3",
		TAG:      "OS COMMAND",
		RUN:      CVE202265914,
		CHECK:    CheckCVE202265914,
		Version:  semver.NewConstraint("9.5.4 - 9.5.8 || 10.0.0 - 10.0.2 "),
	},
	{
		ID:       "CVE-2022-39323",
		SEVERITY: "High",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-cp6q-9p4x-8hr9",
		PATCHv:   "10.0.4",
		RUNTBSQL: CVE202239323,
		TAG:      "TB SQLi",
		CHECK:    CheckCVE202239323,
		Version:  semver.NewConstraint("9.1 - 10.0.3"),
	}, {
		ID:       "CVE-2023-22500",
		SEVERITY: "High",
		URL:      "https://github.com/glpi-project/glpi/security/advisories/GHSA-3ghv-p34r-5ghx",
		PATCHv:   "10.0.6",
		CHECK:    CheckCVE202322500,
		Version:  semver.NewConstraint("10.0.0 - 10.0.6"),
	},
}
